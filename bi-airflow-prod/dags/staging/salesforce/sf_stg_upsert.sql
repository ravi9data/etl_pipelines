/**************************************************************/
delete from stg_salesforce.product2
using stg_salesforce_dl.product2
where stg_salesforce.product2.id = stg_salesforce_dl.product2.id;

INSERT INTO stg_salesforce.product2 (id, "name", productcode, description, isactive, createddate, createdbyid, lastmodifieddate, lastmodifiedbyid, systemmodstamp, family, externaldatasourceid, externalid, displayurl, quantityunitofmeasure, isdeleted, lastvieweddate, lastreferenceddate, shipcloud_profile__c, cost_price__c, category__c, locale__c, test__c, height__c, length__c, weight__c, width__c, device_type__c, sku_product__c, brand__c, oem__c, device_type_desc__c, ean__c, upc__c, sku_variant__c, productfullid__c, image__c)
select id, "name", productcode, description, isactive, createddate, createdbyid, lastmodifieddate, lastmodifiedbyid, systemmodstamp, family, externaldatasourceid, externalid, displayurl, quantityunitofmeasure, isdeleted, lastvieweddate, lastreferenceddate, shipcloud_profile__c, cost_price__c, category__c, locale__c, test__c, height__c, length__c, weight__c, width__c, device_type__c, sku_product__c, brand__c, oem__c, device_type_desc__c, ean__c, upc__c, nullif(sku_variant__c,''), productfullid__c, image__c
from stg_salesforce_dl.product2;

-- truncate table stg_salesforce_dl.product2;

/**************************************************************/

delete from stg_salesforce.asset_payment__c
using stg_salesforce_dl.asset_payment__c
where stg_salesforce.asset_payment__c.id = stg_salesforce_dl.asset_payment__c.id;

INSERT INTO stg_salesforce.asset_payment__c(Id,OwnerId,IsDeleted,Name,RecordTypeId,CreatedDate,CreatedById,LastModifiedDate,LastModifiedById,SystemModstamp,LastActivityDate,allocation__c,amount__c,amount_f_balance__c,amount_f_due__c,amount_f_tax__c,amount_f_vat__c,amount_paid__c,amount_refunded__c,asset__c,charge_id__c,currency__c,customer__c,date_due__c,date_invoice_sent__c,date_invoiced__c,date_paid__c,date_refunded__c,invoice_number__c,invoice_url__c,message__c,order__c,payment_method__c,payment_method_id_1__c,payment_method_id_2__c,rate_sales_tax__c,rate_vat__c,Is_Unbooked_Revenue__c,status__c,tries_charge__c,type__c,date_failed__c,reason__c,date_try_last__c,date_try_next__c,date_pending__c,payment_method_details__c,refund_blocked__c,payment_method_funding__c,related_subscription_payment__c,reason_failed__c,reason_paid__c,force_refunded_into_dc__c,amount_voucher__c,combined_monthly_invoice_url__c,third_party__c,booking_date__c)
SELECT Id,OwnerId,IsDeleted,Name,RecordTypeId,CreatedDate,CreatedById,LastModifiedDate,LastModifiedById,SystemModstamp,LastActivityDate,allocation__c,amount__c,amount_f_balance__c,amount_f_due__c,amount_f_tax__c,amount_f_vat__c,amount_paid__c,amount_refunded__c,asset__c,charge_id__c,currency__c,customer__c,date_due__c,date_invoice_sent__c,date_invoiced__c,date_paid__c,date_refunded__c,invoice_number__c,invoice_url__c,message__c,order__c,payment_method__c,payment_method_id_1__c,payment_method_id_2__c,rate_sales_tax__c,rate_vat__c,Is_Unbooked_Revenue__c,status__c,tries_charge__c,type__c,date_failed__c,reason__c,date_try_last__c,date_try_next__c,date_pending__c,payment_method_details__c,refund_blocked__c,payment_method_funding__c,related_subscription_payment__c,reason_failed__c,reason_paid__c,force_refunded_into_dc__c,amount_voucher__c,combined_monthly_invoice_url__c,third_party__c,booking_date__c
FROM stg_salesforce_dl.asset_payment__c;

-- truncate table stg_salesforce_dl.asset_payment__c;

/**************************************************************/

delete from stg_salesforce.customer_asset_allocation__c
using stg_salesforce_dl.customer_asset_allocation__c
where stg_salesforce.customer_asset_allocation__c.id = stg_salesforce_dl.customer_asset_allocation__c.id;

INSERT INTO stg_salesforce.customer_asset_allocation__c(id, isdeleted, "name", createddate, createdbyid, lastmodifieddate, lastmodifiedbyid, systemmodstamp, lastactivitydate, lastvieweddate, lastreferenceddate, customer__c, asset__c, order__c, shipment_date__c, usage_end_date__c, is_cross_sale__c, to_purchase__c, allocated__c, amount__c, debt_collection_requested__c, shipment_tracking_number__c, shipping_provider__c, cancelltion_requested__c, return_tracking_number__c, asset_name__c, cancelltion_approved__c, weight__c, length__c, width__c, height__c, shipping_label_created__c, picked_by_carrier__c, shipedge__c, shipcloud_shipment_id__c, tracking_url__c, label_url__c, shipment_price__c, delivered__c, shipping_service_type__c, return_label_created__c, return_shipment_provider__c, shipcloud_return_shipment_id__c, return_shipment_price__c, return_picked_by_carrier__c, return_delivered__c, return_tracking_url__c, return_package_height__c, return_package_length__c, return_package_weight__c, return_package_width__c, return_label_url__c, return_label_error__c, shipment_error__c, order_product__c, package_lost__c, asset_length__c, asset_width__c, asset_height__c, asset_weight__c, time_to_ship__c, time_to_deliver__c, insurance_contract_number__c, insurance_pdf_token__c, insurance_rental_period__c, insurance_cancelled__c, insurance_error__c, automatically_allocated__c, ready_to_ship__c, shipedge_shipment_tracking_number__c, shipedge_shipment_tracking_url__c, shipedge_reple_id__c, asset_status__c, renewal__c, renewal_sent__c, return_package_lost__c, cancelltion_in_transit__c, asset_cost_price__c, spree_order_line_id__c, sell_notification_final_re__c, renewal_resent__c, device_type__c, device_type_desc__c, months_rented__c, wh_goods_order_id__c, currency__c, insurance_cancelled_check__c, debt_collection_handover__c, insurance_start__c, subscription_cancellation__c, subscription_cancellation_reason__c, debt_collection_not_recoverable__c, sell_notification_1__c, sell_notification_2__c, sell_notification_3__c, sell_notification_final__c, sell_notification_next_payment__c, sell_status__c, amount_rrp__c, customer_email__c, subscription__c, wh_goods_order_tries__c, asset_serial_number__c, initial_condition__c, initial_external_condition__c, initial_final_condition__c, initial_functional_condition__c, initial_package_condition__c, returned_condition__c, returned_external_condition__c, returned_final_condition__c, returned_functional_condition__c, returned_package_condition__c, wh_goods_order__c, wh_return_announce__c, wh_return_announce_id__c, wh_return_announce_tries__c, asset_sku_variant__c, asset_purchase_shipment_type__c, asset_not_recoverable__c, cancelltion_returned__c, initial_external_condition_note__c, initial_functional_condition_note__c, initial_package_condition_note__c, returned_external_condition_note__c, returned_functional_condition_note__c, returned_package_condition_note__c, status__c, subscription_status__c, subscription_allocation_status__c, returned_condition_reason__c, returned_condition_reported__c, replaced_by__c, replacement_for__c, replacement_date__c, replacement_reason__c, minimum_cancellation_date__c, current_allocation_asset__c, can_create_insurance__c, accessories_cost__c, refurbishment_charge_customer__c, repair_cost__c, unlocking_cost__c, shipcloud_profile__c, in_repair_details__c, incomplete_details__c, locked_details__c, sent_for_unlocking_date__c, failed_delivery__c, widerruf_claim_date__c, reported_issue_reason__c, issue_report_date__c, wh_feedback__c, issue_report_comments__c, widerruf_validity_date__c, shipping_profile__c)
SELECT id, isdeleted, "name", createddate, createdbyid, lastmodifieddate, lastmodifiedbyid, systemmodstamp, lastactivitydate, lastvieweddate, lastreferenceddate, customer__c, asset__c, order__c, shipment_date__c, usage_end_date__c, is_cross_sale__c, to_purchase__c, allocated__c, amount__c, debt_collection_requested__c, nullif(shipment_tracking_number__c,''), shipping_provider__c, cancelltion_requested__c, nullif(return_tracking_number__c,''), asset_name__c, cancelltion_approved__c, weight__c, length__c, width__c, height__c, shipping_label_created__c, picked_by_carrier__c, shipedge__c, shipcloud_shipment_id__c, tracking_url__c, label_url__c, shipment_price__c, delivered__c, shipping_service_type__c, return_label_created__c, return_shipment_provider__c, shipcloud_return_shipment_id__c, return_shipment_price__c, return_picked_by_carrier__c, return_delivered__c, return_tracking_url__c, return_package_height__c, return_package_length__c, return_package_weight__c, return_package_width__c, return_label_url__c, return_label_error__c, shipment_error__c, order_product__c, package_lost__c, asset_length__c, asset_width__c, asset_height__c, asset_weight__c, time_to_ship__c, time_to_deliver__c, insurance_contract_number__c, insurance_pdf_token__c, insurance_rental_period__c, insurance_cancelled__c, insurance_error__c, automatically_allocated__c, ready_to_ship__c, shipedge_shipment_tracking_number__c, shipedge_shipment_tracking_url__c, shipedge_reple_id__c, asset_status__c, renewal__c, renewal_sent__c, return_package_lost__c, cancelltion_in_transit__c, asset_cost_price__c, spree_order_line_id__c, sell_notification_final_re__c, renewal_resent__c, device_type__c, device_type_desc__c, months_rented__c, wh_goods_order_id__c, currency__c, insurance_cancelled_check__c, debt_collection_handover__c, insurance_start__c, subscription_cancellation__c, subscription_cancellation_reason__c, debt_collection_not_recoverable__c, sell_notification_1__c, sell_notification_2__c, sell_notification_3__c, sell_notification_final__c, sell_notification_next_payment__c, sell_status__c, amount_rrp__c, customer_email__c, subscription__c, wh_goods_order_tries__c, asset_serial_number__c, initial_condition__c, initial_external_condition__c, initial_final_condition__c, initial_functional_condition__c, initial_package_condition__c, returned_condition__c, returned_external_condition__c, returned_final_condition__c, returned_functional_condition__c, returned_package_condition__c, wh_goods_order__c, wh_return_announce__c, wh_return_announce_id__c, wh_return_announce_tries__c, asset_sku_variant__c, asset_purchase_shipment_type__c, asset_not_recoverable__c, cancelltion_returned__c, initial_external_condition_note__c, initial_functional_condition_note__c, initial_package_condition_note__c, returned_external_condition_note__c, returned_functional_condition_note__c, returned_package_condition_note__c, status__c, subscription_status__c, subscription_allocation_status__c, returned_condition_reason__c, returned_condition_reported__c, nullif(replaced_by__c,''), nullif(replacement_for__c,''), replacement_date__c, replacement_reason__c, minimum_cancellation_date__c, current_allocation_asset__c, can_create_insurance__c, accessories_cost__c, refurbishment_charge_customer__c, repair_cost__c, unlocking_cost__c, shipcloud_profile__c, in_repair_details__c, incomplete_details__c, locked_details__c, sent_for_unlocking_date__c, failed_delivery__c, widerruf_claim_date__c, reported_issue_reason__c, issue_report_date__c, wh_feedback__c, issue_report_comments__c, widerruf_validity_date__c, shipping_profile__c
FROM stg_salesforce_dl.customer_asset_allocation__c;

-- truncate table stg_salesforce_dl.customer_asset_allocation__c;

/**************************************************************/

truncate table stg_salesforce.purchase_request__c;

INSERT INTO stg_salesforce.purchase_request__c(Id,OwnerId,IsDeleted,Name,CreatedDate,CreatedById,LastModifiedDate,LastModifiedById,SystemModstamp,LastActivityDate,LastViewedDate,LastReferencedDate,delivered_to_warehouse_at__c,delivered_date__c,delivery_number__c,eta__c,in_delivery_date__c,purchase_date__c,purchase_order_number__c,state_note__c,purchased__c,purchased_date__c,external_id__c,vat__c,source_of_capital__c,status__c,supplier__c,warehouse__c,wh_goods_receipt__c,wh_goods_receipt_error__c,wh_goods_receipt_id__c,wh_goods_receipt_response__c,wh_goods_receipt_tries__c,cancelled_date__c,items__c,total_price__c,total_quantity__c,purchase_payment_method__c)
SELECT Id,OwnerId,IsDeleted,Name,CreatedDate,CreatedById,LastModifiedDate,LastModifiedById,SystemModstamp,LastActivityDate,LastViewedDate,LastReferencedDate,delivered_to_warehouse_at__c,delivered_date__c,delivery_number__c,eta__c,in_delivery_date__c,purchase_date__c,purchase_order_number__c,state_note__c,purchased__c,purchased_date__c,external_id__c,vat__c,source_of_capital__c,status__c,supplier__c,warehouse__c,wh_goods_receipt__c,wh_goods_receipt_error__c,wh_goods_receipt_id__c,wh_goods_receipt_response__c,wh_goods_receipt_tries__c,cancelled_date__c,items__c,total_price__c,total_quantity__c,purchase_payment_method__c
FROM stg_salesforce_dl.purchase_request__c;

-- truncate table stg_salesforce_dl.purchase_request__c;
/**************************************************************/

delete from stg_salesforce.asset
using stg_salesforce_dl.asset
where stg_salesforce.asset.id = stg_salesforce_dl.asset.id;

INSERT INTO stg_salesforce.asset(id, contactid, accountid, parentid, rootassetid, product2id, iscompetitorproduct, createddate, createdbyid, lastmodifieddate, lastmodifiedbyid, systemmodstamp, isdeleted, "name", serialnumber, installdate, purchasedate, usageenddate, status, price, quantity, description, ownerid, lastvieweddate, lastreferenceddate, sku__c, asset_id__c, invoice_number__c, proposed_to_customer__c, condition__c, order_number__c, sell_price__c, shop__c, cost_price__c, coeo_claim_closed_date__c, supplier__c, asset_allocation__c, test__c, purchased__c, height__c, length__c, width__c, weight__c, shipedge__c, purchased_request__c, in_repair_details__c, last_usage_end_date__c, customer_request__c, invoice_date__c, invoice_url__c, brand__c, device_type__c, amount_rrp__c, incomplete_details__c, locked_details__c, comtech_article_number__c, comtech_price__c, sold__c, sell_price_with_fees__c, note__c, days__c, days_in_stock__c, offered_customer_name__c, leasing__c, leasing_start__c, leasing_amount__c, leasing_term__c, warehouse__c, availability_status__c, procurement_status__c, asset_quality__c, device_type_desc__c, warehouse_shipping_id__c, warehouse_target__c, repair_amount__c, repair_registered_date__c, actual_asset_value__c, lost_reason__c, condition_note__c, sum_of_rents__c, potential_sum_of_rents__c, potential_asset_value__c, number_of_rents__c, currency_new__c, selling_order_number__c, components_cost__c, capital_source__c, sync_payments_debt__c, sync_payments_expected__c, sync_payments_profit__c, sync_payments_refunded__c, sync_payments_tax__c, sync_payments_paid__c, revenue_share__c, theoretical_purchase_price__c, dc_claim_closed_date__c, spree_product_variant_id__c, coeo_claim_last_update_date__c, final_condition__c, cross_sale_attempt_date__c, purchase_request__c, wh_goods_receipt__c, product_ean__c, upc__c, currency__c, cost_price_calculated__c, exchange_rate__c, currency_capital_source__c, cost_price_capital_source__c, sync_capital_source_payments_debt__c, sync_capital_source_payments_expected__c, sync_capital_source_payments_paid__c, sync_capital_source_payments_profit__c, sync_capital_source_payments_refunded__c, to_update__c, purchase_payment_method__c, payment_due_date__c, invoice_total__c, debt_collection_not_recoverable__c, rrp_diff__c, sell_voucher__c, wh_goods_receipt_id__c, number__c, eta_shipping_note__c, eta__c, eta_asap__c, wh_goods_receipt_tries__c, supplier_name__c, wh_goods_receipt_delivery_number__c, external_condition__c, functional_condition__c, package_condition__c, f_product_sku_product__c, f_product_sku_variant__c, wh_goods_receipt_transfer_type__c, purchase_dropship__c, purchase_shipment_eta__c, purchase_shipment_type__c, warehouse_refurbishment__c, external_condition_note__c, functional_condition_note__c, package_condition_note__c, coeo_claim_date__c, coeo_claim_error__c, coeo_claim_id__c, coeo_claim_response__c, coeo_claim_status__c, purchase_request_item__c, dc_claim_id__c, in_stock_date__c, days_in_warehouse__c, manual_allocation__c, capital_source_name__c, sap_database_name__c, category__c, date_of_sale__c, sale_amount__c, selling_agent__c, stock_id__c, do_not_touch_belongs_to_mix__c, lost_reason_note__c )
SELECT id, contactid, accountid, parentid, rootassetid, product2id, iscompetitorproduct, createddate, createdbyid, lastmodifieddate, lastmodifiedbyid, systemmodstamp, isdeleted, "name", nullif(serialnumber,''), installdate, purchasedate, usageenddate, status, price, quantity, description, ownerid, lastvieweddate, lastreferenceddate, sku__c, asset_id__c, invoice_number__c, proposed_to_customer__c, nullif(condition__c,''), order_number__c, sell_price__c, shop__c, cost_price__c, coeo_claim_closed_date__c, supplier__c, nullif(asset_allocation__c,''), test__c, purchased__c, height__c, length__c, width__c, weight__c, shipedge__c, purchased_request__c, in_repair_details__c, last_usage_end_date__c, customer_request__c, invoice_date__c, invoice_url__c, brand__c, device_type__c, amount_rrp__c, incomplete_details__c, locked_details__c, comtech_article_number__c, comtech_price__c, sold__c, sell_price_with_fees__c, note__c, days__c, days_in_stock__c, offered_customer_name__c, leasing__c, leasing_start__c, leasing_amount__c, leasing_term__c, warehouse__c, availability_status__c, procurement_status__c, asset_quality__c, device_type_desc__c, warehouse_shipping_id__c, warehouse_target__c, repair_amount__c, repair_registered_date__c, actual_asset_value__c, lost_reason__c, condition_note__c, sum_of_rents__c, potential_sum_of_rents__c, potential_asset_value__c, number_of_rents__c, currency_new__c, selling_order_number__c, components_cost__c, capital_source__c, sync_payments_debt__c, sync_payments_expected__c, sync_payments_profit__c, sync_payments_refunded__c, sync_payments_tax__c, sync_payments_paid__c, revenue_share__c, theoretical_purchase_price__c, dc_claim_closed_date__c, spree_product_variant_id__c, coeo_claim_last_update_date__c, final_condition__c, cross_sale_attempt_date__c, purchase_request__c, wh_goods_receipt__c, product_ean__c, upc__c, currency__c, cost_price_calculated__c, exchange_rate__c, currency_capital_source__c, cost_price_capital_source__c, sync_capital_source_payments_debt__c, sync_capital_source_payments_expected__c, sync_capital_source_payments_paid__c, sync_capital_source_payments_profit__c, sync_capital_source_payments_refunded__c, to_update__c, purchase_payment_method__c, payment_due_date__c, invoice_total__c, debt_collection_not_recoverable__c, rrp_diff__c, sell_voucher__c, wh_goods_receipt_id__c, number__c, eta_shipping_note__c, eta__c, eta_asap__c, wh_goods_receipt_tries__c, nullif(supplier_name__c,''), wh_goods_receipt_delivery_number__c, external_condition__c, functional_condition__c, package_condition__c, f_product_sku_product__c, f_product_sku_variant__c, wh_goods_receipt_transfer_type__c, purchase_dropship__c, purchase_shipment_eta__c, purchase_shipment_type__c, warehouse_refurbishment__c, external_condition_note__c, functional_condition_note__c, package_condition_note__c, coeo_claim_date__c, coeo_claim_error__c, coeo_claim_id__c, coeo_claim_response__c, coeo_claim_status__c, purchase_request_item__c, dc_claim_id__c, in_stock_date__c, days_in_warehouse__c, manual_allocation__c, capital_source_name__c, sap_database_name__c, category__c, date_of_sale__c, sale_amount__c, selling_agent__c, stock_id__c, do_not_touch_belongs_to_mix__c, lost_reason_note__c
FROM stg_salesforce_dl.asset;

-- truncate table stg_salesforce_dl.asset;
/**************************************************************/

delete from stg_salesforce.account
using stg_salesforce_dl.account
where stg_salesforce.account.id = stg_salesforce_dl.account.id;

INSERT INTO stg_salesforce.account(id, isdeleted, masterrecordid, "name", "type", parentid, billingstreet, billingcity, billingstate, billingpostalcode, billingcountry, billinglatitude, billinglongitude, billinggeocodeaccuracy, shippingstreet, shippingcity, shippingstate, shippingpostalcode, shippingcountry, shippinglatitude, shippinglongitude, shippinggeocodeaccuracy, phone, website, photourl, industry, annualrevenue, numberofemployees, description, ownerid, createddate, createdbyid, lastmodifieddate, lastmodifiedbyid, systemmodstamp, lastactivitydate, lastvieweddate, lastreferenceddate, jigsawcompanyid, birthdate__c, email__c, locale__c, payment_service__c, spree_customer_id__c, test__c, name_normalized__c, is_blacklisted__c, age__c, customer_details_payments__c, payments_holded_reason__c, payments_reminder__c, email_recurrent_failed__c, intercom_user_agent__c, birthday_email_sent__c, next_birthday__c, last_nps_survey_sent_date__c, manual_allocation__c, refer_a_friend_sent_date__c, subscription_limit_change_date__c, subscription_limit_define_date__c, combined_monthly_invoiced_date__c, billing_company__c, shipping_company__c, last_late_payment_email_sent__c, user_type__c, language__c, company__c, items_limit__c, items_order_limit__c, customer_type__c, payments_holded__c, debt_collection__c, is_whitelisted__c, debt_collection_sent__c, payments_holded_until__c, debt_collection_not_recoverable__c, gender__c, email_verified__c, legal_prosecution__c, debt_collection_closed__c, legal_prosecution_url__c, dc_closed__c, dc_not__c, dc_open__c, debt_collection_requested__c, debt_collection_process__c, debt_collection_handover__c, debt_collection_status__c, debt_collection_update__c, debt_collection_update_last__c, payment_recovery_status__c)
SELECT id, isdeleted, masterrecordid, "name", "type", parentid, billingstreet, billingcity, billingstate, billingpostalcode, billingcountry, billinglatitude, billinglongitude, billinggeocodeaccuracy, shippingstreet, shippingcity, shippingstate, shippingpostalcode, shippingcountry, shippinglatitude, shippinglongitude, shippinggeocodeaccuracy, phone, website, photourl, industry, annualrevenue, numberofemployees, description, ownerid, createddate, createdbyid, lastmodifieddate, lastmodifiedbyid, systemmodstamp, lastactivitydate, lastvieweddate, lastreferenceddate, jigsawcompanyid, birthdate__c, email__c, locale__c, payment_service__c, nullif(spree_customer_id__c,''), test__c, name_normalized__c, is_blacklisted__c, age__c, customer_details_payments__c, payments_holded_reason__c, payments_reminder__c, email_recurrent_failed__c, intercom_user_agent__c, birthday_email_sent__c, next_birthday__c, last_nps_survey_sent_date__c, manual_allocation__c, refer_a_friend_sent_date__c, subscription_limit_change_date__c, subscription_limit_define_date__c, combined_monthly_invoiced_date__c, billing_company__c, shipping_company__c, last_late_payment_email_sent__c, user_type__c, language__c, company__c, items_limit__c, items_order_limit__c, customer_type__c, payments_holded__c, debt_collection__c, is_whitelisted__c, debt_collection_sent__c, payments_holded_until__c, debt_collection_not_recoverable__c, gender__c, email_verified__c, legal_prosecution__c, debt_collection_closed__c, legal_prosecution_url__c, dc_closed__c, dc_not__c, dc_open__c, debt_collection_requested__c, debt_collection_process__c, debt_collection_handover__c, debt_collection_status__c, debt_collection_update__c, debt_collection_update_last__c, payment_recovery_status__c
FROM stg_salesforce_dl.account;

-- truncate table stg_salesforce_dl.account;
/****************************************************************************************/

delete from stg_salesforce.Contact
using stg_salesforce_dl.Contact
where stg_salesforce.Contact.id = stg_salesforce_dl.Contact.id;

INSERT INTO stg_salesforce.Contact(id,isdeleted,masterrecordid,accountid,lastname,firstname,salutation,middlename,suffix,name,mailingstreet,mailingcity,mailingstate,mailingpostalcode,mailingcountry,mailinglatitude,mailinglongitude,mailinggeocodeaccuracy,phone,fax,mobilephone,reportstoid,email,title,department,birthdate,ownerid,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastcurequestdate,lastcuupdatedate,lastvieweddate,lastreferenceddate,emailbouncedreason,emailbounceddate,isemailbounced,photourl,jigsawcontactid,spree_customer_id__c,delete_requested__c,delete_approved__c,delete_reason__c,phone_is_valid__c,phone_is_prepaid__c,twilio_response__c,language__c,has_appropriate_account__c)
SELECT id,isdeleted,masterrecordid,accountid,lastname,firstname,salutation,middlename,suffix,name,mailingstreet,mailingcity,mailingstate,mailingpostalcode,mailingcountry,mailinglatitude,mailinglongitude,mailinggeocodeaccuracy,phone,fax,mobilephone,reportstoid,email,title,department,birthdate,ownerid,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastcurequestdate,lastcuupdatedate,lastvieweddate,lastreferenceddate,emailbouncedreason,emailbounceddate,isemailbounced,photourl,jigsawcontactid,spree_customer_id__c,delete_requested__c,delete_approved__c,delete_reason__c,phone_is_valid__c,phone_is_prepaid__c,twilio_response__c,language__c,has_appropriate_account__c
FROM stg_salesforce_dl.Contact;

-- truncate table stg_salesforce_dl.Contact;
/****************************************************************************************/

delete from stg_salesforce.Supplier__c
using stg_salesforce_dl.Supplier__c
where stg_salesforce.Supplier__c.id = stg_salesforce_dl.Supplier__c.id;

INSERT INTO stg_salesforce.Supplier__c(id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,default_purchase_payment_method__c,delivery_time__c,delivery_cost__c,minimal_order_amount__c,dropship_ability__c,locale__c,default_capital_source__c,default_warehouse__c,active_rules_count__c)
SELECT id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,default_purchase_payment_method__c,delivery_time__c,delivery_cost__c,minimal_order_amount__c,dropship_ability__c,locale__c,default_capital_source__c,default_warehouse__c,active_rules_count__c
FROM stg_salesforce_dl.Supplier__c;

-- truncate table stg_salesforce_dl.Supplier__c;
/****************************************************************************************/

delete from stg_salesforce.Task
using stg_salesforce_dl.Task
where stg_salesforce.Task.id = stg_salesforce_dl.Task.id;

INSERT INTO stg_salesforce.Task(id,whoid,whatid,whocount,whatcount,subject,activitydate,status,priority,ishighpriority,ownerid,description,type,isdeleted,accountid,isclosed,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,isarchived,calldurationinseconds,calltype,calldisposition,callobject,reminderdatetime,isreminderset,recurrenceactivityid,isrecurrence,recurrencestartdateonly,recurrenceenddateonly,recurrencetimezonesidkey,recurrencetype,recurrenceinterval,recurrencedayofweekmask,recurrencedayofmonth,recurrenceinstance,recurrencemonthofyear,recurrenceregeneratedtype,tasksubtype,category__c,assignee__c,customer__c)
SELECT id,whoid,whatid,whocount,whatcount,subject,activitydate,status,priority,ishighpriority,ownerid,description,type,isdeleted,accountid,isclosed,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,isarchived,calldurationinseconds,calltype,calldisposition,callobject,reminderdatetime,isreminderset,recurrenceactivityid,isrecurrence,recurrencestartdateonly,recurrenceenddateonly,recurrencetimezonesidkey,recurrencetype,recurrenceinterval,recurrencedayofweekmask,recurrencedayofmonth,recurrenceinstance,recurrencemonthofyear,recurrenceregeneratedtype,tasksubtype,category__c,assignee__c,customer__c
FROM stg_salesforce_dl.Task;

-- truncate table stg_salesforce_dl.Task;
/****************************************************************************************/

delete from stg_salesforce.User
using stg_salesforce_dl.User
where stg_salesforce.User.id = stg_salesforce_dl.User.id;

INSERT INTO stg_salesforce.User(id,username,lastname,firstname,middlename,suffix,name,companyname,division,department,title,street,city,state,postalcode,country,latitude,longitude,geocodeaccuracy,email,emailpreferencesautobcc,emailpreferencesautobccstayintouch,emailpreferencesstayintouchreminder,senderemail,sendername,signature,stayintouchsubject,stayintouchsignature,stayintouchnote,phone,fax,mobilephone,alias,communitynickname,badgetext,isactive,timezonesidkey,userroleid,localesidkey,receivesinfoemails,receivesadmininfoemails,emailencodingkey,profileid,usertype,languagelocalekey,employeenumber,delegatedapproverid,managerid,lastlogindate,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,offlinetrialexpirationdate,offlinepdatrialexpirationdate,userpermissionsmarketinguser,userpermissionsofflineuser,userpermissionsavantgouser,userpermissionscallcenterautologin,userpermissionssfcontentuser,userpermissionsinteractionuser,userpermissionssupportuser,userpermissionschatteranswersuser,forecastenabled,userpreferencesactivityreminderspopup,userpreferenceseventreminderscheckboxdefault,userpreferencestaskreminderscheckboxdefault,userpreferencesremindersoundoff,userpreferencesdisableallfeedsemail,userpreferencesdisablefollowersemail,userpreferencesdisableprofilepostemail,userpreferencesdisablechangecommentemail,userpreferencesdisablelatercommentemail,userpreferencesdisprofpostcommentemail,userpreferencesapexpagesdevelopermode,userpreferenceshidecsngetchattermobiletask,userpreferencesdisablementionspostemail,userpreferencesdismentionscommentemail,userpreferenceshidecsndesktoptask,userpreferenceshidechatteronboardingsplash,userpreferenceshidesecondchatteronboardingsplash,userpreferencesdiscommentafterlikeemail,userpreferencesdisablelikeemail,userpreferencessortfeedbycomment,userpreferencesdisablemessageemail,userpreferencesdisablebookmarkemail,userpreferencesdisablesharepostemail,userpreferencesenableautosubforfeeds,userpreferencesdisablefilesharenotificationsforapi,userpreferencesshowtitletoexternalusers,userpreferencesshowmanagertoexternalusers,userpreferencesshowemailtoexternalusers,userpreferencesshowworkphonetoexternalusers,userpreferencesshowmobilephonetoexternalusers,userpreferencesshowfaxtoexternalusers,userpreferencesshowstreetaddresstoexternalusers,userpreferencesshowcitytoexternalusers,userpreferencesshowstatetoexternalusers,userpreferencesshowpostalcodetoexternalusers,userpreferencesshowcountrytoexternalusers,userpreferencesshowprofilepictoguestusers,userpreferencesshowtitletoguestusers,userpreferencesshowcitytoguestusers,userpreferencesshowstatetoguestusers,userpreferencesshowpostalcodetoguestusers,userpreferencesshowcountrytoguestusers,userpreferenceshides1browserui,userpreferencesdisableendorsementemail,userpreferencespathassistantcollapsed,userpreferencescachediagnostics,userpreferencesshowemailtoguestusers,userpreferencesshowmanagertoguestusers,userpreferencesshowworkphonetoguestusers,userpreferencesshowmobilephonetoguestusers,userpreferencesshowfaxtoguestusers,userpreferencesshowstreetaddresstoguestusers,userpreferenceslightningexperiencepreferred,userpreferenceshideenduseronboardingassistantmodal,userpreferenceshidelightningmigrationmodal,userpreferenceshidesfxwelcomemat,userpreferenceshidebiggerphotocallout,userpreferencesglobalnavbarwtshown,userpreferencesglobalnavgridmenuwtshown,userpreferencescreatelexappswtshown,userpreferencesfavoriteswtshown,userpreferencesrecordhomesectioncollapsewtshown,userpreferencesrecordhomereservedwtshown,userpreferencesfavoritesshowtopfavorites,contactid,accountid,callcenterid,extension,federationidentifier,aboutme,fullphotourl,smallphotourl,isextindicatorvisible,mediumphotourl,digestfrequency,defaultgroupnotificationfrequency,lastvieweddate,lastreferenceddate,bannerphotourl,smallbannerphotourl,mediumbannerphotourl,isprofilephotoactive)
SELECT id,username,lastname,firstname,middlename,suffix,name,companyname,division,department,title,street,city,state,postalcode,country,latitude,longitude,geocodeaccuracy,email,emailpreferencesautobcc,emailpreferencesautobccstayintouch,emailpreferencesstayintouchreminder,senderemail,sendername,signature,stayintouchsubject,stayintouchsignature,stayintouchnote,phone,fax,mobilephone,alias,communitynickname,badgetext,isactive,timezonesidkey,userroleid,localesidkey,receivesinfoemails,receivesadmininfoemails,emailencodingkey,profileid,usertype,languagelocalekey,employeenumber,delegatedapproverid,managerid,lastlogindate,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,offlinetrialexpirationdate,offlinepdatrialexpirationdate,userpermissionsmarketinguser,userpermissionsofflineuser,userpermissionsavantgouser,userpermissionscallcenterautologin,userpermissionssfcontentuser,userpermissionsinteractionuser,userpermissionssupportuser,userpermissionschatteranswersuser,forecastenabled,userpreferencesactivityreminderspopup,userpreferenceseventreminderscheckboxdefault,userpreferencestaskreminderscheckboxdefault,userpreferencesremindersoundoff,userpreferencesdisableallfeedsemail,userpreferencesdisablefollowersemail,userpreferencesdisableprofilepostemail,userpreferencesdisablechangecommentemail,userpreferencesdisablelatercommentemail,userpreferencesdisprofpostcommentemail,userpreferencesapexpagesdevelopermode,userpreferenceshidecsngetchattermobiletask,userpreferencesdisablementionspostemail,userpreferencesdismentionscommentemail,userpreferenceshidecsndesktoptask,userpreferenceshidechatteronboardingsplash,userpreferenceshidesecondchatteronboardingsplash,userpreferencesdiscommentafterlikeemail,userpreferencesdisablelikeemail,userpreferencessortfeedbycomment,userpreferencesdisablemessageemail,userpreferencesdisablebookmarkemail,userpreferencesdisablesharepostemail,userpreferencesenableautosubforfeeds,userpreferencesdisablefilesharenotificationsforapi,userpreferencesshowtitletoexternalusers,userpreferencesshowmanagertoexternalusers,userpreferencesshowemailtoexternalusers,userpreferencesshowworkphonetoexternalusers,userpreferencesshowmobilephonetoexternalusers,userpreferencesshowfaxtoexternalusers,userpreferencesshowstreetaddresstoexternalusers,userpreferencesshowcitytoexternalusers,userpreferencesshowstatetoexternalusers,userpreferencesshowpostalcodetoexternalusers,userpreferencesshowcountrytoexternalusers,userpreferencesshowprofilepictoguestusers,userpreferencesshowtitletoguestusers,userpreferencesshowcitytoguestusers,userpreferencesshowstatetoguestusers,userpreferencesshowpostalcodetoguestusers,userpreferencesshowcountrytoguestusers,userpreferenceshides1browserui,userpreferencesdisableendorsementemail,userpreferencespathassistantcollapsed,userpreferencescachediagnostics,userpreferencesshowemailtoguestusers,userpreferencesshowmanagertoguestusers,userpreferencesshowworkphonetoguestusers,userpreferencesshowmobilephonetoguestusers,userpreferencesshowfaxtoguestusers,userpreferencesshowstreetaddresstoguestusers,userpreferenceslightningexperiencepreferred,userpreferenceshideenduseronboardingassistantmodal,userpreferenceshidelightningmigrationmodal,userpreferenceshidesfxwelcomemat,userpreferenceshidebiggerphotocallout,userpreferencesglobalnavbarwtshown,userpreferencesglobalnavgridmenuwtshown,userpreferencescreatelexappswtshown,userpreferencesfavoriteswtshown,userpreferencesrecordhomesectioncollapsewtshown,userpreferencesrecordhomereservedwtshown,userpreferencesfavoritesshowtopfavorites,contactid,accountid,callcenterid,extension,federationidentifier,aboutme,fullphotourl,smallphotourl,isextindicatorvisible,mediumphotourl,digestfrequency,defaultgroupnotificationfrequency,lastvieweddate,lastreferenceddate,bannerphotourl,smallbannerphotourl,mediumbannerphotourl,isprofilephotoactive
FROM stg_salesforce_dl.User;

-- truncate table stg_salesforce_dl."user";
/****************************************************************************************/

delete from stg_salesforce.asset_insurance__c
using stg_salesforce_dl.asset_insurance__c
where stg_salesforce.asset_insurance__c.id = stg_salesforce_dl.asset_insurance__c.id;

INSERT INTO stg_salesforce.asset_insurance__c(id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,allocation__c,asset__c,company__c,contract__c,currency__c,end__c,months__c,premium_rate__c,premium_total__c,start__c,renting_period__c,coverage__c,serial_number__c,has_serial_number_changed__c)
SELECT id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,allocation__c,asset__c,company__c,contract__c,currency__c,end__c,months__c,premium_rate__c,premium_total__c,start__c,renting_period__c,coverage__c,serial_number__c,has_serial_number_changed__c
FROM stg_salesforce_dl.asset_insurance__c;

-- truncate table stg_salesforce_dl.asset_insurance__c;
/****************************************************************************************/

delete from stg_salesforce.asset_request__c
using stg_salesforce_dl.asset_request__c
where stg_salesforce.asset_request__c.id = stg_salesforce_dl.asset_request__c.id;

INSERT INTO stg_salesforce.asset_request__c(id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,customer_name__c,customer_email__c,product_name__c,product_sku__c,test__c,offer_sent__c,order_product_url__c,slug__c,shop_url__c,creation_date__c,request_id__c,store__c,note__c,x2nd_week_notice__c,x4th_week_notice__c,x4th_week_notice_voucher__c,product__c)
SELECT id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,customer_name__c,customer_email__c,product_name__c,product_sku__c,test__c,offer_sent__c,order_product_url__c,slug__c,shop_url__c,creation_date__c,request_id__c,store__c,note__c,x2nd_week_notice__c,x4th_week_notice__c,x4th_week_notice_voucher__c,product__c
FROM stg_salesforce_dl.asset_request__c;

-- truncate table stg_salesforce_dl.asset_request__c;
/****************************************************************************************/

delete from stg_salesforce.capital_source__c
using stg_salesforce_dl.capital_source__c
where stg_salesforce.capital_source__c.id = stg_salesforce_dl.capital_source__c.id;

update stg_salesforce_dl.capital_source__c
set name = 'SUSTAINABLE TECH RENTAL EUROPE II GMBH'
where  stg_salesforce_dl.capital_source__c.id = 'a0F070000006CBtEAM';

INSERT INTO stg_salesforce.capital_source__c(id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,amount__c,spent_manual_marketing__c,spent_manual_shipping__c,money_received_date__c,rate__c,type__c,money_spent__c,money_left__c,currency__c,sync_number_assets__c,sync_number_assets_eu__c,sync_number_assets_us__c,sync_payments_debt__c,sync_payments_expected__c,sync_payments_paid__c,sync_payments_profit__c,sync_payments_refunded__c,sync_value_assets__c,sync_value_assets_eu__c,sync_value_assets_rate__c,sync_value_assets_us__c,sap_database_name__c,address__c,source_group__c,default_payment_method__c)
SELECT id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,amount__c,spent_manual_marketing__c,spent_manual_shipping__c,money_received_date__c,rate__c,type__c,money_spent__c,money_left__c,currency__c,sync_number_assets__c,sync_number_assets_eu__c,sync_number_assets_us__c,sync_payments_debt__c,sync_payments_expected__c,sync_payments_paid__c,sync_payments_profit__c,sync_payments_refunded__c,sync_value_assets__c,sync_value_assets_eu__c,sync_value_assets_rate__c,sync_value_assets_us__c,sap_database_name__c,address__c,source_group__c,default_payment_method__c
FROM stg_salesforce_dl.capital_source__c;

-- truncate table stg_salesforce_dl.capital_source__c;
/****************************************************************************************/

delete from stg_salesforce.order
using stg_salesforce_dl.order
where stg_salesforce.order.id = stg_salesforce_dl.order.id;

INSERT INTO stg_salesforce.order(id,ownerid,contractid,accountid,pricebook2id,originalorderid,quoteid,effectivedate,enddate,isreductionorder,status,description,customerauthorizedbyid,companyauthorizedbyid,type,billingstreet,billingcity,billingstate,billingpostalcode,billingcountry,billinglatitude,billinglongitude,billinggeocodeaccuracy,shippingstreet,shippingcity,shippingstate,shippingpostalcode,shippingcountry,shippinglatitude,shippinglongitude,shippinggeocodeaccuracy,podate,ponumber,billtocontactid,activateddate,activatedbyid,statuscode,ordernumber,totalamount,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,isdeleted,systemmodstamp,lastvieweddate,lastreferenceddate,customer_email__c,spree_order_number__c,spree_order_total__c,ip__c,locale__c,needs_reassignement__c,customer_name__c,customer_phone__c,test__c,order_creation__c,pricebook__c,paid__c,completed__c,approved__c,store__c,state_verified__c,payment_method_name__c,payment_method_type__c,paypal_token__c,paypal_payer_id__c,paypal_transaction_id__c,paypal_profile_id__c,error__c,spree_amount_diff__c,wh_goods_order__c,wh_goods_order_number__c,payments_reminder_first_last__c,payments_reminder_first__c,state_cancelled__c,previous_payment_methods__c,welcome_letter_link__c,x24h_pending_reminder_send__c,source__c,coupon_extended__c,coupon_extended_value__c,scoring_decision__c,return_label_in_welcome_letter__c,offline_store_unit_code__c,goods_transfer_protocol__c,partner_collective_bill__c,insurance_type__c,manual_review_ends_at__c,goods_transfer_protocol_link__c,partner_collective_bill_link__c,ip_address__c,warning__c,state_shipped__c,grand_total__c,reason__c,welcome_pages__c,approval_date_change_reason__c,state_delivered__c,shipedge_sent__c,shipedge_status__c,shipedge_id__c,skip_declined_failed_first_payment__c,shipping_company__c,billing_company__c,note__c,days__c,customer_name_shipping__c,cancellation_status__c,tax_rate__c,tax_rate_response__c,spree_customer_id__c,welcome_letter_url__c,external__c,voucher__c,store_id__c,cross_sale_attempts__c,product_names__c,state_pending_shipment__c,pick_up_date__c,pick_up_form_url__c,voucherify_coupon_type__c,voucherify_coupon_value__c,voucherify_discount__c,voucherify_tracking_id__c,shipping_additional_info__c,sepa_mandate_id__c,sepa_mandate_date__c,state_approved__c,shipcloud_profile__c,amount_adjustment__c,amount_final__c,amount_shipment__c,amount_tax__c,amount_voucher__c,payment_method__c,payment_method_id_1__c,payment_method_id_2__c,reason_held__c,payments_run_start__c,pick_up_form__c,welcome_letter__c,payments_run_first__c,payments_run_first_last__c)
SELECT id,ownerid,contractid,accountid,pricebook2id,originalorderid,quoteid,effectivedate,enddate,isreductionorder,status,description,customerauthorizedbyid,companyauthorizedbyid,type,billingstreet,billingcity,billingstate,billingpostalcode,billingcountry,billinglatitude,billinglongitude,billinggeocodeaccuracy,shippingstreet,shippingcity,shippingstate,shippingpostalcode,shippingcountry,shippinglatitude,shippinglongitude,shippinggeocodeaccuracy,podate,ponumber,billtocontactid,activateddate,activatedbyid,statuscode,ordernumber,totalamount,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,isdeleted,systemmodstamp,lastvieweddate,lastreferenceddate,customer_email__c,spree_order_number__c,spree_order_total__c,ip__c,locale__c,needs_reassignement__c,customer_name__c,customer_phone__c,test__c,order_creation__c,pricebook__c,paid__c,completed__c,approved__c,store__c,state_verified__c,payment_method_name__c,payment_method_type__c,paypal_token__c,paypal_payer_id__c,paypal_transaction_id__c,paypal_profile_id__c,error__c,spree_amount_diff__c,wh_goods_order__c,wh_goods_order_number__c,payments_reminder_first_last__c,payments_reminder_first__c,state_cancelled__c,previous_payment_methods__c,welcome_letter_link__c,x24h_pending_reminder_send__c,source__c,coupon_extended__c,coupon_extended_value__c,scoring_decision__c,return_label_in_welcome_letter__c,offline_store_unit_code__c,goods_transfer_protocol__c,partner_collective_bill__c,insurance_type__c,manual_review_ends_at__c,goods_transfer_protocol_link__c,partner_collective_bill_link__c,ip_address__c,warning__c,state_shipped__c,grand_total__c,reason__c,welcome_pages__c,approval_date_change_reason__c,state_delivered__c,shipedge_sent__c,shipedge_status__c,shipedge_id__c,skip_declined_failed_first_payment__c,shipping_company__c,billing_company__c,note__c,days__c,customer_name_shipping__c,cancellation_status__c,tax_rate__c,tax_rate_response__c,spree_customer_id__c,welcome_letter_url__c,external__c,voucher__c,store_id__c,cross_sale_attempts__c,product_names__c,state_pending_shipment__c,pick_up_date__c,pick_up_form_url__c,voucherify_coupon_type__c,voucherify_coupon_value__c,voucherify_discount__c,voucherify_tracking_id__c,shipping_additional_info__c,sepa_mandate_id__c,sepa_mandate_date__c,state_approved__c,shipcloud_profile__c,amount_adjustment__c,amount_final__c,amount_shipment__c,amount_tax__c,amount_voucher__c,payment_method__c,payment_method_id_1__c,payment_method_id_2__c,reason_held__c,payments_run_start__c,pick_up_form__c,welcome_letter__c,payments_run_first__c,payments_run_first_last__c
FROM stg_salesforce_dl.order;

-- truncate table stg_salesforce_dl."order";
/****************************************************************************************/

delete from stg_salesforce.orderitem
using stg_salesforce_dl.orderitem
where stg_salesforce.orderitem.id = stg_salesforce_dl.orderitem.id;

INSERT INTO stg_salesforce.orderitem(id,product2id,isdeleted,orderid,pricebookentryid,originalorderitemid,availablequantity,quantity,unitprice,listprice,totalprice,description,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,orderitemnumber,spree_order_line_id__c,is_allocation_done__c,cost_price__c,spree_subscription_line_id__c,spree_subscription_discount__c,spree_subscription_months__c,spree_subscription__c,spree_subscription_id__c,discount__c,total_discount__c,first_month_discount_amount__c,minimum_term_months__c,product_name__c,product_id__c,rental_plan_price__c,ean__c,trial_days__c,device_type__c,brand__c,f_product_sku_product__c,f_product_sku_variant__c,serial_numbers__c,purchase_prices__c,variant_flexibility__c,cost_price_total__c,amount_total__c,amount_rrp__c)
SELECT id,product2id,isdeleted,orderid,pricebookentryid,originalorderitemid,availablequantity,quantity,unitprice,listprice,totalprice,description,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,orderitemnumber,spree_order_line_id__c,is_allocation_done__c,cost_price__c,spree_subscription_line_id__c,spree_subscription_discount__c,spree_subscription_months__c,spree_subscription__c,spree_subscription_id__c,discount__c,total_discount__c,first_month_discount_amount__c,minimum_term_months__c,product_name__c,product_id__c,rental_plan_price__c,ean__c,trial_days__c,device_type__c,brand__c,f_product_sku_product__c,f_product_sku_variant__c,serial_numbers__c,purchase_prices__c,variant_flexibility__c,cost_price_total__c,amount_total__c,amount_rrp__c
FROM stg_salesforce_dl.orderitem;

-- truncate table stg_salesforce_dl.orderitem;
/****************************************************************************************/

truncate table stg_salesforce.purchase_request_item__c;

INSERT INTO stg_salesforce.purchase_request_item__c(id,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,purchase_request__c,currency__c,effective_quantity__c,final_quantity__c,purchase_price__c,purchase_quantity__c,rrp__c,total__c,variant__c,delivered__c,delivered_text__c,manual_allocation__c,lost__c,fully_booked__c,external_id__c)
SELECT id,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,purchase_request__c,currency__c,effective_quantity__c,final_quantity__c,purchase_price__c,purchase_quantity__c,rrp__c,total__c,variant__c,delivered__c,delivered_text__c,manual_allocation__c,lost__c,fully_booked__c,external_id__c
FROM stg_salesforce_dl.purchase_request_item__c;

-- truncate table stg_salesforce_dl.purchase_request_item__c;
/****************************************************************************************/

delete from stg_salesforce.refund_payment__c
using stg_salesforce_dl.refund_payment__c
where stg_salesforce.refund_payment__c.id = stg_salesforce_dl.refund_payment__c.id;

INSERT INTO stg_salesforce.refund_payment__c(id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,allocation__c,amount__c,amount_f_due__c,amount_f_sales_tax__c,amount_f_vat__c,amount_refunded__c,asset__c,asset_payment__c,charge_id__c,currency__c,customer__c,date_cancelled__c,date_failed__c,date_paid__c,date_pending__c,date_try_next__c,message__c,order__c,payment_method__c,payment_method_id_1__c,payment_method_id_2__c,rate_sales_tax__c,rate_vat__c,reason__c,refund_id__c,status__c,subscription__c,subscription_payment__c,tries__c,type__c,can_be_refunded__c,amount_refunded_sum__c,amount_repaid__c,date_repaid__c)
SELECT id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,allocation__c,amount__c,amount_f_due__c,amount_f_sales_tax__c,amount_f_vat__c,amount_refunded__c,asset__c,asset_payment__c,charge_id__c,currency__c,customer__c,date_cancelled__c,date_failed__c,date_paid__c,date_pending__c,date_try_next__c,message__c,order__c,payment_method__c,payment_method_id_1__c,payment_method_id_2__c,rate_sales_tax__c,rate_vat__c,reason__c,refund_id__c,status__c,subscription__c,subscription_payment__c,tries__c,type__c,can_be_refunded__c,amount_refunded_sum__c,amount_repaid__c,date_repaid__c
FROM stg_salesforce_dl.refund_payment__c;

-- truncate table stg_salesforce_dl.refund_payment__c;
/****************************************************************************************/

delete from stg_salesforce.store__c
using stg_salesforce_dl.store__c
where stg_salesforce.store__c.id = stg_salesforce_dl.store__c.id;

INSERT INTO stg_salesforce.store__c(id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,contact_person__c,email__c,offline__c,rent_with_grover__c,store_id__c,supplier__c,website__c,locale__c,confirmation_email_template__c,extra_pdf_attachment_template__c,rent_with_grover_offline_accepted_templa__c,active_rules_count__c,welcome_letter_custom_logo_path__c,auto_approval__c,offline_store_unit_code__c,rent_with_grover_offline_rejected_templa__c,handoff_doc_set__c)
SELECT id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,contact_person__c,email__c,offline__c,rent_with_grover__c,store_id__c,supplier__c,website__c,locale__c,confirmation_email_template__c,extra_pdf_attachment_template__c,rent_with_grover_offline_accepted_templa__c,active_rules_count__c,welcome_letter_custom_logo_path__c,auto_approval__c,offline_store_unit_code__c,rent_with_grover_offline_rejected_templa__c,handoff_doc_set__c
FROM stg_salesforce_dl.store__c;

-- truncate table stg_salesforce_dl.store__c;
/****************************************************************************************/

delete from stg_salesforce.subscription__c
using stg_salesforce_dl.subscription__c
where stg_salesforce.subscription__c.id = stg_salesforce_dl.subscription__c.id;

INSERT INTO stg_salesforce.subscription__c(id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,amount__c,cancellation_reason__c,currency__c,customer__c,date_cancellation__c,date_cancellation_requested__c,date_renewal__c,date_renewal_confirmed__c,date_renewal_next__c,date_renewal_requested__c,date_start__c,number__c,order__c,order_product__c,status__c,amount_credit__c,amount_rrp__c,payment_method__c,payment_method_id_1__c,payment_method_id_2__c,payments_run_last__c,allocation_status__c,coeo_claim_last_update_date__c,recirculation_voucher__c,renewal_day__c,date_first_asset_delivery__c,coeo_claim_date__c,coeo_claim_response__c,coeo_claim_error__c,coeo_claim_status__c,coeo_claim_id__c,pdf_uri_template__c,order_product_name__c,allocation_tries__c,cross_sale_attempts__c,manual_allocation_attempts__c,replacement_attempts__c,minimum_cancellation_date__c,dc_customer_contact_result__c,dc_deadline__c,returned_survey_email_sent__c,coeo_claim_closed_date__c,agency_for_dc_processing__c,minimum_term_months_old__c,automatic_handover_date__c,reactivated_from_dc__c,minimum_term_months__c,spree_order_number__c,dc_agency_case_id__c,expiration_reminder_date__c,cancellation_note__c,cancellation_reason_picklist__c,subscription_id__c)
SELECT id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,amount__c,cancellation_reason__c,currency__c,customer__c,date_cancellation__c,date_cancellation_requested__c,date_renewal__c,date_renewal_confirmed__c,date_renewal_next__c,date_renewal_requested__c,date_start__c,number__c,order__c,order_product__c,status__c,amount_credit__c,amount_rrp__c,payment_method__c,payment_method_id_1__c,payment_method_id_2__c,payments_run_last__c,allocation_status__c,coeo_claim_last_update_date__c,recirculation_voucher__c,renewal_day__c,date_first_asset_delivery__c,coeo_claim_date__c,coeo_claim_response__c,coeo_claim_error__c,coeo_claim_status__c,coeo_claim_id__c,pdf_uri_template__c,order_product_name__c,allocation_tries__c,cross_sale_attempts__c,manual_allocation_attempts__c,replacement_attempts__c,minimum_cancellation_date__c,dc_customer_contact_result__c,dc_deadline__c,returned_survey_email_sent__c,coeo_claim_closed_date__c,agency_for_dc_processing__c,minimum_term_months_old__c,automatic_handover_date__c,reactivated_from_dc__c,minimum_term_months__c,spree_order_number__c,dc_agency_case_id__c,expiration_reminder_date__c,cancellation_note__c,cancellation_reason_picklist__c,subscription_id__c
FROM stg_salesforce_dl.subscription__c;

-- truncate table stg_salesforce_dl.subscription__c;
/****************************************************************************************/

delete from stg_salesforce.subscription_payment__c
using stg_salesforce_dl.subscription_payment__c
where stg_salesforce.subscription_payment__c.id = stg_salesforce_dl.subscription_payment__c.id;

INSERT INTO stg_salesforce.subscription_payment__c(id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,amount_f_debt__c,amount_f_due__c,amount_f_profit__c,amount_f_revenue__c,amount_f_sum__c,amount_f_sales_tax__c,amount_f_vat__c,amount_paid__c,amount_discount__c,amount_refunded__c,amount_shipment__c,amount_subscription__c,amount_voucher__c,asset__c,charge_id__c,charges__c,currency__c,customer__c,date_debt_collection_handover__c,date_debt_collection_requested__c,date_due__c,date_failed__c,date_held__c,date_invoice_sent__c,date_invoiced__c,date_paid__c,date_refunded__c,date_try_next__c,f_debt_collection_status__c,f_paid_debt_agency__c,f_paid_manually__c,f_refund_type__c,invoice_url__c,invoice_number__c,message__c,number__c,order__c,f_paid_type__c,payment_method__c,payment_method_id_1__c,payment_method_id_2__c,rate_sales_tax__c,rate_vat__c,reason_failed__c,reason_held__c,reason_paid__c,is_dumb_payment__c,status__c,tries_charge__c,type__c,allocation__c,date_debt_collection_not_recoverable__c,amount_fake__c,exchange_rate__c,can_recurrent_be_charged__c,exchange_rate_capital_source__c,date_cancel__c,reason_cancel__c,order_product__c,amount_f_due_without_taxes__c,f_rate_rrp__c,retry_with_the_same_payment_method__c,f_capital_source_amount_due__c,f_capital_source_amount_due_without_tax__c,f_capital_source_amount_profit__c,f_capital_source_amount_debt__c,f_asset_amount_due__c,f_asset_amount_due_without_tax__c,f_asset_amount_profit__c,f_asset_amount_debt__c,customer_email__c,subscription__c,date_billing_end__c,date_billing_start__c,failed_fully__c,date_pending__c,payment_method_details__c,refund_blocked__c,should_create_invoice__c,payment_method_funding__c,refunded_greater__c,force_refunded_into_dc__c,combined_monthly_invoice_url__c,x1st_warning_sent_date__c,x2nd_warning_sent_date__c,overdue_fee_amount__c,x3rd_warning_sent_date__c,allocation_status__c,date_chargedback__c,force_into_dc__c)
SELECT id,ownerid,isdeleted,name,createddate,createdbyid,lastmodifieddate,lastmodifiedbyid,systemmodstamp,lastactivitydate,lastvieweddate,lastreferenceddate,amount_f_debt__c,amount_f_due__c,amount_f_profit__c,amount_f_revenue__c,amount_f_sum__c,amount_f_sales_tax__c,amount_f_vat__c,amount_paid__c,amount_discount__c,amount_refunded__c,amount_shipment__c,amount_subscription__c,amount_voucher__c,asset__c,charge_id__c,charges__c,currency__c,customer__c,date_debt_collection_handover__c,date_debt_collection_requested__c,date_due__c,date_failed__c,date_held__c,date_invoice_sent__c,date_invoiced__c,date_paid__c,date_refunded__c,date_try_next__c,f_debt_collection_status__c,f_paid_debt_agency__c,f_paid_manually__c,f_refund_type__c,invoice_url__c,invoice_number__c,message__c,number__c,order__c,f_paid_type__c,payment_method__c,payment_method_id_1__c,payment_method_id_2__c,rate_sales_tax__c,rate_vat__c,reason_failed__c,reason_held__c,reason_paid__c,is_dumb_payment__c,status__c,tries_charge__c,type__c,allocation__c,date_debt_collection_not_recoverable__c,amount_fake__c,exchange_rate__c,can_recurrent_be_charged__c,exchange_rate_capital_source__c,date_cancel__c,reason_cancel__c,order_product__c,amount_f_due_without_taxes__c,f_rate_rrp__c,retry_with_the_same_payment_method__c,f_capital_source_amount_due__c,f_capital_source_amount_due_without_tax__c,f_capital_source_amount_profit__c,f_capital_source_amount_debt__c,f_asset_amount_due__c,f_asset_amount_due_without_tax__c,f_asset_amount_profit__c,f_asset_amount_debt__c,customer_email__c,subscription__c,date_billing_end__c,date_billing_start__c,failed_fully__c,date_pending__c,payment_method_details__c,refund_blocked__c,should_create_invoice__c,payment_method_funding__c,refunded_greater__c,force_refunded_into_dc__c,combined_monthly_invoice_url__c,x1st_warning_sent_date__c,x2nd_warning_sent_date__c,overdue_fee_amount__c,x3rd_warning_sent_date__c,allocation_status__c,date_chargedback__c,force_into_dc__c
FROM stg_salesforce_dl.subscription_payment__c;

-- truncate table stg_salesforce_dl.subscription_payment__c;
/**************************************************************/
